---
title: |
  | **DS 223: Marketing Analytics**  
  | Homework 1 - Bass Model
  | Sonos Era 300 
author: "Ani Aloyan"
date: "October 18, 2024"
output:
  pdf_document: default
  html_document: default

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, echo = TRUE)
```

The Sonos Era 300 was chosen as one of the TOP 200 most innovative devices of 2023, according to Times. This paper aims to develop an effective bass model in order to simulate and analyze the potential market adoption and sales for Sonos 300.

The Sonos Era 300 is a wireless speaker that delivers great sound quality and works with smart home systems, making it easy to use for everyday listening.

```{r, echo = FALSE}
library(diffusion)
library(ggplot2)
library(reshape2)
library(ggpubr)
library(readxl)
library(gridExtra)

```

To start, it is essential to find a similar product that has been introduced before, and analyze its data. Apple Homepod is a good match for this task as they both are high-end, wireless smart speakers designed to deliver exceptional sound quality and integrate seamlessly with smart home ecosystems.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
data <- read_excel("statistic_id1421706_apple-homepod-sales-2018-2023.xlsx", 
                   sheet = "Data",range = "B6:C11", col_names = FALSE)
colnames(data) <- c("Year", "Sales")
data$Sales <- data$Sales 
data
```
The number of Apple Homepod sales (in millions) from years 2018-2023 is shown below.

```{r, out.width="70%"}
ggplot(data, aes(Year, Sales)) + geom_bar(stat = 'identity') + theme_minimal()
```


The histogram illustrates the distribution of the Sales over years, and it is nicely depicting how the stages of  product life cycle; starting slowly, reaching its peak and entering the phase of decline.



Now the Homepod data is passed to diffusion model to estimate the parameters p,q,m for the bass model.

m - market potential
p - innovators rate 
q - immitators rate

```{r}
t <- seq(1,length(data$Year))
diff_m = diffusion(data$Sales)
p=round(diff_m$w,4)[2]
q=round(diff_m$w,4)[3]
m=round(diff_m$w,4)[1]
diff_m

```

#### Defining functions for f(t) and F(T)

- f (t) the fraction of the total market that adopts at time t
- F(t) the fraction of the total market that has adopted up to and including time t

```{r}
# function for f(t)
bass.f <- function(t,p,q) {
  ((p + q) ^ 2 / p) * exp(-(p + q) * t) / (1 + (q / p) * exp(-(p + q) * t)) ^ 2
}


# function for F(t)
bass.F <- function(t,p,q) {
  (1 - exp(-(p + q) * t)) / (1 + (q / p) * exp(-(p + q) * t))
}

```


### Plotting

```{r, out.width = "85%"}
f_plot <- ggplot(data, aes(t)) +
  stat_function(fun = bass.f, args = c(p, q)) + 
  labs(title = "Adoption Rate f(t)", x = "time", y = "f(t)") +
  theme_minimal()

F_plot <- ggplot(data, aes(t)) +
  stat_function(fun = bass.F, args = c(p, q))+ 
  labs(title = "Cumulative adoption Rate F(t)", x = "time", y = "f(t)") +
  theme_minimal()

ggarrange(f_plot, F_plot)
```


```{r, out.width="75%"}
data$preds = bass.f(t, p, q) * m
ggplot(data = data, aes(Year, Sales)) +
  geom_bar(stat = 'identity', fill = "lightgray") +
  geom_point(aes(Year, preds), color = 'red') + theme_minimal() + 
  labs(title = "The Prediction of the Sonos Sales (red) vs Apple Homepod Sales")
```

```{r}
data
```

## Estimation of global market using Fermi's approach 

- assume 30% of the people will not be able to afford this expensive speaker. 
( the price of Sonos is more than of Homepod's)

- 10% of the Homepod buyers are extremely loyal to Apple and won't switch

(no actual data on this assumptions)

```{r}
m_new = m * (1 - 0.3) * (1 - 0.1)

data$pred_new = bass.f(1:nrow(data), p = p, q = q)*m_new

```

Estimating the number of adopters over time using the parameters of the bass model

```{r, out.width="75%"}
ggplot(data, mapping = aes(x=Year, y=pred_new, group =1))+ 
  
  geom_point(color = 'red')+ geom_line() + theme_minimal() + labs(y = "Predicted Sales")

```


### Estimation of adopters by segments 

Innovators : 2.5%
Early Adopters : 13.5%
Early Majority : 34%
Late Majority: 34%
Laggards : 16%

```{r}
sales_total = sum(data$pred_new)

Innovators <- 0.025 * sales_total
Early_Adopters <- 0.135 * sales_total
Early_Majority <- 0.34 * sales_total
Late_Majority <- 0.34 * sales_total
Laggards <- 0.16 * sales_total
```


```{r}
segment_estimates <- data.frame(Category = c("Innovators", "Early Adopters", "Early Majority",
                                             "Late Majority", "Laggards"), 
                        Population_Count = c(Innovators, Early_Adopters,                                                                                Early_Majority, Late_Majority, Laggards))

segment_estimates

```

References 

- Sonos Era 300 (Times) : https://time.com/collection/best-inventions-2023/6324054/sonos-era-300/
- Sonos Era 300 Price : https://www.sonos.com/en/shop/era-300
- Homepod Sales : https://www.statista.com/statistics/1421706/apple-homepod-unit-sales/
- Homepod Price : https://www.apple.com/homepod/




